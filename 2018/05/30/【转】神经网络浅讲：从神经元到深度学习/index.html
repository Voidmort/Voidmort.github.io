<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.3.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.3.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.3.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.3.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="这又是我常看的大神写的一篇博客，从最初的从机器学习谈起使我入门机器学习，到现在学到了神经网络，又找到了他的博客，希望对我学习神经网络有所帮助。 原文地址：https://www.cnblogs.com/subconscious/p/5058741.html#first 作者：计算机的潜意识                                         　　神经网络是一门重要的机器">
<meta name="keywords" content="机器学习，神经网络">
<meta property="og:type" content="article">
<meta property="og:title" content="【转】神经网络浅讲：从神经元到深度学习">
<meta property="og:url" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/index.html">
<meta property="og:site_name" content="Voidmort">
<meta property="og:description" content="这又是我常看的大神写的一篇博客，从最初的从机器学习谈起使我入门机器学习，到现在学到了神经网络，又找到了他的博客，希望对我学习神经网络有所帮助。 原文地址：https://www.cnblogs.com/subconscious/p/5058741.html#first 作者：计算机的潜意识                                         　　神经网络是一门重要的机器">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151229110952448-2017198041.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151219151604318-1557737289.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151219174631693-775181930.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151229121248198-818698949.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151219175550990-1730772549.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151219175600006-1000051743.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151219153856802-307732621.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151219180614819-1652574235.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151230201441792-1505283920.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151230204036479-461440948.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151219175742677-1785435491.gif">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151221153812609-1784157068.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151221151959015-1876891081.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151230204223917-579926148.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151230204258057-82126781.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151230204606760-610264555.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151230205437995-673856644.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151231073138323-962584420.png">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151221213056031-351364155.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151222162306171-1025091923.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151222163144687-406696976.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151222164731249-360921014.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151222171056156-387680541.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151222171328140-1303075636.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151226111144687-604911384.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151231073619073-461403542.png">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151231074314604-2050732128.png">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151226122337406-1923048422.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151229120754198-2003498733.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151224114218312-1112152935.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151224145544656-1225191900.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151224204339234-1994620313.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151224212531484-570745053.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151224213620234-1075501325.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151224213703109-813423001.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151231075103229-1126297331.png">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151228131815214-368589404.png">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151228131718948-1881649621.png">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151228170208120-1856567090.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151228134016120-1091351096.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151228170149135-2107087462.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151227175114031-277810977.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151231172950167-1599238944.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151227190543499-2614280.jpg">
<meta property="og:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151230155838057-551533589.jpg">
<meta property="og:updated_time" content="2018-08-12T07:39:52.899Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="【转】神经网络浅讲：从神经元到深度学习">
<meta name="twitter:description" content="这又是我常看的大神写的一篇博客，从最初的从机器学习谈起使我入门机器学习，到现在学到了神经网络，又找到了他的博客，希望对我学习神经网络有所帮助。 原文地址：https://www.cnblogs.com/subconscious/p/5058741.html#first 作者：计算机的潜意识                                         　　神经网络是一门重要的机器">
<meta name="twitter:image" content="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/673793-20151229110952448-2017198041.jpg">



  <link rel="alternate" href="/atom.xml" title="Voidmort" type="application/atom+xml" />




  <link rel="canonical" href="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>【转】神经网络浅讲：从神经元到深度学习 | Voidmort</title>
  






  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?7b96eb7c2717359e36cc8bd8b546997c";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>
<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    <a href="https://github.com/Voidmort" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Voidmort</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />关于</a>
  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />搜索</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xvjie.wang/2018/05/30/【转】神经网络浅讲：从神经元到深度学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Voidmort">
      <meta itemprop="description" content="研究AI，撰写影评，热爱音乐，努力健身">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Voidmort">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">【转】神经网络浅讲：从神经元到深度学习
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-30 00:00:00" itemprop="dateCreated datePublished" datetime="2018-05-30T00:00:00+08:00">2018-05-30</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-08-12 15:39:52" itemprop="dateModified" datetime="2018-08-12T15:39:52+08:00">2018-08-12</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/转载/" itemprop="url" rel="index"><span itemprop="name">转载</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>这又是我常看的大神写的一篇博客，从最初的从机器学习谈起使我入门机器学习，到现在学到了神经网络，又找到了他的博客，希望对我学习神经网络有所帮助。</p>
<p>原文地址：<a href="https://www.cnblogs.com/subconscious/p/5058741.html#first" target="_blank" rel="noopener">https://www.cnblogs.com/subconscious/p/5058741.html#first</a></p>
<p>作者：计算机的潜意识</p>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><div id="main"><br>    <div id="mainContent"><br>    <div class="forFlow"><br><br><div id="post_detail"><br><!--done--><br><div id="topics"><br>    <div class="post"><br>        <div class="clear"></div><br>        <div class="postBody"><br>            <div id="cnblogs_post_body" class="blogpost-body"><p class="p">　　神经网络是一门重要的机器学习技术。它是目前最为火热的研究方向<span style="font-family: Verdana;">–</span>深度学习的基础。学习神经网络不仅可以让你掌握一门强大的机器学习方法，同时也可以更好地帮助你理解深度学习技术。</p><br><p class="p">　　本文以一种简单的，循序的方式讲解神经网络。适合对神经网络了解不多的同学。本文对阅读没有一定的前提要求，但是懂一些<a title="从机器学习谈起" href="http://www.cnblogs.com/subconscious/p/4107357.html" target="_blank">机器学习</a>基础会更好地帮助理解本文。</p><br><p class="p">　　神经网络是一种模拟人脑的神经网络以期能够实现类人工智能的机器学习技术。人脑中的神经网络是一个非常复杂的组织。成人的大脑中估计有<span style="font-family: Verdana;">1000</span><span style="font-family: 宋体;">亿个神经元之多。</span></p><br><p style="text-align: center;"><img src="673793-20151229110952448-2017198041.jpg" alt="" width="429" height="321"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图1 人脑神经网络</span></p><br><p style="text-align: center;">&nbsp;</p><br><p>　　那么机器学习中的神经网络是如何实现这种模拟的，并且达到一个惊人的良好效果的？通过本文，你可以了解到这些问题的答案，同时还能知道神经网络的历史，以及如何较好地学习它。</p><br><p>　　由于本文较长，为方便读者，以下是本文的目录：</p><br><p>　　一.<a href="https://www.cnblogs.com/subconscious/p/5058741.html#first" target="_blank" rel="noopener">前言</a></p><br><p>　　二.<a href="https://www.cnblogs.com/subconscious/p/5058741.html#second" target="_blank" rel="noopener">神经元</a></p><br><p>　　三.<a href="https://www.cnblogs.com/subconscious/p/5058741.html#third" target="_blank" rel="noopener">单层神经网络（感知器）</a></p><br><p>　　四.<a href="https://www.cnblogs.com/subconscious/p/5058741.html#fourth" target="_blank" rel="noopener">两层神经网络（多层感知器）</a></p><br><p>　　五.<a href="https://www.cnblogs.com/subconscious/p/5058741.html#fifth" target="_blank" rel="noopener">多层神经网络（深度学习）</a></p><br><p>　　六.<a href="https://www.cnblogs.com/subconscious/p/5058741.html#sixth" target="_blank" rel="noopener">回顾</a></p><br><p>　　七.<a href="https://www.cnblogs.com/subconscious/p/5058741.html#seventh" target="_blank" rel="noopener">展望</a><a href="https://www.cnblogs.com/subconscious/p/5058741.html#sixth" target="_blank" rel="noopener"><br></a></p><br><p>　　八.<a href="https://www.cnblogs.com/subconscious/p/5058741.html#eighth" target="_blank" rel="noopener">总结</a><a href="https://www.cnblogs.com/subconscious/p/5058741.html#nineth" target="_blank" rel="noopener"><br></a></p><br><p>　　九.<a href="https://www.cnblogs.com/subconscious/p/5058741.html#nineth" target="_blank" rel="noopener">后记</a></p><br><p>　　十.<a href="https://www.cnblogs.com/subconscious/p/5058741.html#tenth" target="_blank" rel="noopener">备注</a><a href="https://www.cnblogs.com/subconscious/p/5058741.html#tenth" target="_blank" rel="noopener"><br></a></p><br><p>&nbsp;</p><br><p><strong><a name="first"></a>一. 前言</strong></p><br><p class="p">　　让我们来看一个经典的神经网络。这是一个包含三个层次的神经网络。红色的是<strong>输入层</strong>，绿色的是<strong>输出层</strong>，紫色的是<strong>中间层</strong>（也叫<strong>隐藏层</strong>）。输入层有<span style="font-family: Verdana;">3</span><span style="font-family: 宋体;">个输入</span>单元，隐藏层有<span style="font-family: Verdana;">4</span><span style="font-family: 宋体;">个</span>单元，输出层有<span style="font-family: Verdana;">2</span><span style="font-family: 宋体;">个</span>单元。后文中，我们统一使用这种颜色来表达神经网络的结构。</p><br><p style="text-align: center;"><span style="font-family: 宋体;"><img src="673793-20151219151604318-1557737289.jpg" alt="" width="329" height="463"></span></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图2 神经网络结构图</span></p><br><p style="text-align: center;">&nbsp;</p><br><p class="p">　　在开始介绍前，有一些知识可以先记在心里：</p><br><ol><br><li>设计一个神经网络时，输入层与输出层的节点数往往是固定的，中间层则可以自由指定；</li><br><li>神经网络结构图中的拓扑与箭头代表着<strong>预测</strong>过程时数据的流向，跟<strong>训练</strong>时的数据流有一定的区别；</li><br><li><span style="font-family: 宋体;">结构图里的关键不是圆圈（代表“神经元”），而是连接线（代表“神经元”之间的连接）。每个连接线对应一个不同的<strong>权重</strong>（其值称为<strong>权值</strong>），这是需要训练得到的</span>。<span style="font-family: Verdana;">&nbsp;</span>&nbsp;</li><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></ol><br><p><span style="font-family: 宋体;">　　除了从左到右的形式表达的结构图，还有一种常见的表达形式是从下到上来表示一个神经网络。这时候，输入层在图的最下方。输出层则在图的最上方，如下图：</span></p><br><p style="text-align: center;"><img src="673793-20151219174631693-775181930.jpg" alt="" width="486" height="313"></p><br><p style="text-align: center;"><span style="line-height: 1.5; font-family: 黑体;">图3&nbsp;从下到上的神经网络结构图</span>&nbsp;</p><br><p style="text-align: center;">&nbsp;</p><br><p style="text-align: left;"><span style="line-height: 1.5;">　　从左到右的表达形式以</span><span style="font-family: Verdana;">Andrew&nbsp;Ng</span><span style="font-family: 宋体;">和</span><span style="font-family: Verdana;">LeCun</span><span style="font-family: 宋体;">的文献使用较多，</span><span style="font-family: Verdana;">Caffe</span><span style="font-family: 宋体;">里使用的则是从下到上的表达。在本文中使用</span><span style="font-family: Verdana;">Andrew&nbsp;Ng</span><span style="font-family: 宋体;">代表的从左到右的表达形式。</span></p><br><p class="p"><span style="font-family: 宋体;">　　</span><span style="font-family: 宋体;">下面从简单的神经元开始说起，一步一步介绍神经网络复杂结构的形成。</span></p><br><p class="p">&nbsp;</p><br><p><strong><a name="second"></a>二.&nbsp;神经元</strong></p><br><p>　　<strong>1.引子</strong><strong><strong>　</strong></strong></p><br><p>　　对于神经元的研究由来已久，1904年生物学家就已经知晓了神经元的组成结构。</p><br><p>　　一个神经元通常具有多个<strong>树突</strong>，主要用来接受传入信息；而<strong>轴突</strong>只有一条，轴突尾端有许多轴突末梢可以给其他多个神经元传递信息。轴突末梢跟其他神经元的树突产生连接，从而传递信号。这个连接的位置在生物学上叫做<span style="font-family: 宋体;">“<strong>突触</strong>”</span>。</p><br><p>　　人脑中的神经元形状可以用下图做简单的说明：</p><br><p style="text-align: center;"><img src="673793-20151229121248198-818698949.jpg" alt="" width="477" height="284"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图4 神经元</span></p><br><p style="text-align: center;">&nbsp;</p><br><p>&nbsp;　　1943年，心理学家McCulloch和数学家Pitts参考了生物神经元的结构，发表了抽象的神经元模型MP。在下文中，我们会具体介绍神经元模型。</p><br><p style="text-align: center;"><img src="673793-20151219175550990-1730772549.jpg" alt="" width="181" height="238">&nbsp;&nbsp;&nbsp;<img src="673793-20151219175600006-1000051743.jpg" alt="" width="167" height="237"></p><br><p style="text-align: center;"><span style="font-family: 黑体; font-size: 14px;">图5 Warren McCulloch（左）和&nbsp;Walter Pitts（右）</span>&nbsp;&nbsp;</p><br><p><strong>　　2.结构</strong>&nbsp;</p><br><p>　　神经元模型是一个包含输入，输出与计算功能的模型。输入可以类比为神经元的树突，而输出可以类比为神经元的轴突，计算则可以类比为细胞核。</p><br><p>　　下图是一个典型的神经元模型：包含有3个输入，1个输出，以及2个计算功能。</p><br><p>　　注意中间<span style="font-family: 宋体;">的箭头线。这些线称为“连接”。每个上有一个“权值”</span>。</p><br><p style="text-align: center;"><img src="673793-20151219153856802-307732621.jpg" alt="" width="608" height="354"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图6 神经元模型</span>&nbsp;</p><br><p style="text-align: center;">&nbsp;</p><br><p>　　连接是神经元中最重要的东西。每一个连接上都有一个权重。</p><br><p>　　一个神经网络的训练算法就是让权重的值调整到最佳，以使得整个网络的预测效果最好。</p><br><p>　　我们使用a来表示输入，用w来表示权值。一个表示连接的有向箭头可以这样理解：在初端，传递的信号大小仍然是a，端中间有加权参数w，经过这个加权后的信号会变成a<em>w，因此在连接的末端，信号的大小就变成了a</em>w。</p><br><p>　　在其他绘图模型里，有向箭头可能表示的是值的不变传递。而在神经元模型里，每个有向箭头表示的是值的加权传递。</p><br><p style="text-align: center;"><img src="673793-20151219180614819-1652574235.jpg" alt="" width="445" height="256"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图7 连接（connection）&nbsp;</span>&nbsp;</p><br><p style="text-align: center;">&nbsp;</p><br><p>　　如果我们将神经元图中的所有变量用符号表示，并且写出输出的计算公式的话，就是下图。</p><br><p style="text-align: center;"><img src="673793-20151230201441792-1505283920.jpg" alt="" width="625" height="334"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图8 神经元计算&nbsp;</span>&nbsp;</p><br><p style="text-align: center;">&nbsp;</p><br><p>　　可见z是在输入和权值的线性加权和叠加了一个<strong>函数g</strong>的值。在MP模型里，函数g是sgn函数，也就是取符号函数。这个函数当输入大于0时，输出1，否则输出0。</p><br><p>　　下面对神经元模型的图进行一些扩展。首先将sum函数与sgn函数合并到一个圆圈里，代表神经元的内部计算。其次，把输入a与输出z写到连接线的左上方，便于后面画复杂的网络。最后说明，一个神经元可以引出多个代表输出的有向箭头，但值都是一样的。</p><br><p>　　神经元可以看作一个计算与存储单元。计算是神经元对其的输入进行计算功能。存储是神经元会暂存计算结果，并传递到下一层。</p><br><p style="text-align: center;"><img src="673793-20151230204036479-461440948.jpg" alt="" width="828" height="315"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图9 神经元扩展</span>&nbsp;</p><br><p style="text-align: center;">&nbsp;</p><br><p style="text-align: left;">　　<span style="font-family: 宋体;">当我们用“神经元”组成网络以后，描述网络中的某个“神经元”时，我们更多地会用“<strong>单元</strong>”（<span style="font-family: verdana, geneva;">unit</span>）来指代。同时由于神经网络的表现形式是一个有向图，有时也会用“<strong>节点</strong>”（<span style="font-family: verdana, geneva;">node</span>）来表达同样的意思。</span>&nbsp;</p><br><p><strong>　　3.效果</strong>&nbsp;</p><br><p>　　神经元模型的使用可以这样理解：</p><br><p>　　我们有一个数据，称之为样本。样本有四个属性，其中三个属性已知，一个属性未知。我们需要做的就是通过三个已知属性<strong>预测</strong>未知属性。</p><br><p>　　具体办法就是使用神经元的公式进行计算。三个已知属性的值是a<sub>1</sub>，a<sub>2</sub>，a<sub>3</sub>，未知属性的值是z。z可以通过公式计算出来。</p><br><p>　　这里，已知的属性称之为<strong>特征</strong>，未知的属性称之为<strong>目标</strong>。假设特征与目标之间确实是线性关系，并且我们已经得到表示这个关系的权值w<sub>1</sub>，w<sub>2</sub>，w<sub>3</sub>。那么，我们就可以通过神经元模型预测新样本的目标。</p><br><p><strong>　　4.影响</strong></p><br><p>　　1943年发布的MP模型，虽然简单，但已经建立了神经网络大厦的地基。但是，MP模型中，权重的值都是预先设置的，因此不能学习。</p><br><p>　　1949年心理学家Hebb提出了Hebb学习率，认为人脑神经细胞的<strong>突触</strong>（也就是连接）上的强度上可以变化的。于是计算科学家们开始考虑用调整权值的方法来让机器学习。这为后面的学习算法奠定了基础。</p><br><p style="text-align: center;"><img src="673793-20151219175742677-1785435491.gif" alt="" width="179" height="231"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图10 Donald Olding Hebb</span>&nbsp;</p><br><p style="text-align: center;">&nbsp;</p><br><p>　　尽管神经元模型与Hebb学习律都已诞生，但限于当时的计算机能力，直到接近10年后，第一个真正意义的神经网络才诞生。</p><br><p>&nbsp;</p><br><p><strong><a name="third"></a>三. 单层神经网络（感知器）</strong></p><br><p><strong>　　1.引子</strong><strong>　</strong>　</p><br><p>　　1958年，计算科学家Rosenblatt提出了由两层神经元组成的神经网络。他给它起了一个名字–<span style="font-family: 宋体;">“感知器”</span>（Perceptron）（有的文献翻译成<span style="font-family: 宋体;">“感知机”，下文统一用“感知器”来指代</span>）。</p><br><p>　　感知器是当时首个可以学习的人工神经网络。Rosenblatt现场演示了其学习识别简单图像的过程，在当时的社会引起了轰动。</p><br><p>　　人们认为已经发现了智能的奥秘，许多学者和科研机构纷纷投入到神经网络的研究中。美国军方大力资助了神经网络的研究，并认为神经网络比<span style="font-family: 宋体;">“原子弹工程”</span>更重要。这段时间直到1969年才结束，这个时期可以看作神经网络的第一次高潮。</p><br><p style="text-align: center;"><img src="673793-20151221153812609-1784157068.jpg" alt="" width="520" height="239"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图11 Rosenblat与感知器&nbsp;</span></p><br><p><strong>　　2.结构</strong></p><br><p>　　下面来说明感知器模型。</p><br><p>　　在原来MP模型的<span style="font-family: 宋体;">“输入”</span>位置添加神经元节点，标志其为<span style="font-family: 宋体;">“输入单元”</span>。其余不变，于是我们就有了下图：从本图开始，我们将权值<span style="font-family: verdana, geneva;">w<sub>1</sub>, w<sub>2</sub>, w<sub>3</sub></span>写到<span style="font-family: 宋体;">“连接线”的中间</span>。</p><br><p style="text-align: center;"><img src="673793-20151221151959015-1876891081.jpg" alt="" width="308" height="339"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图12 单层神经网络</span>&nbsp;</p><br><p style="text-align: center;">&nbsp;</p><br><p>　　<span style="font-family: 宋体;">在“感知器”中</span>，有两个层次。分别是输入层和输出层。<span style="font-family: 宋体;">输入层里的“输入单元”只负责传输数据，</span>不做计算。<span style="font-family: 宋体;">输出层里的“输出单元”则需要对前面一层的输入进行计算。</span></p><br><p>　　我们把需要计算的层次称之为<span style="font-family: 宋体;">“计算层”</span>，并把拥有一个计算层的网络称之为<span style="font-family: 宋体;">“单层神经网络”</span>。有一些文献会按照网络拥有的层数来命名，例如把<span style="font-family: 宋体;">“感知器”称为两层神经网络。但在本文里，</span>我们根据计算层的数量来命名。</p><br><p>　　假如我们要预测的目标不再是一个值，而是一个向量，例如[2,3]。那么可以在输出层再增加一个<span style="font-family: 宋体;">“输出单元”</span>。</p><br><p>　　下图显示了带有两个输出单元的单层神经网络，其中输出单元z<sub>1</sub>的计算公式如下图。</p><br><p style="text-align: center;"><img src="673793-20151230204223917-579926148.jpg" alt="" width="583" height="365"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图13 单层神经网络(Z<sub>1</sub>)</span></p><br><p style="text-align: center;">&nbsp;</p><br><p>　　可以看到，z<sub>1</sub>的计算跟原先的z并没有区别。</p><br><p>　　我们已知一个神经元的输出可以向多个神经元传递，因此z<sub>2</sub>的计算公式如下图。</p><br><p style="text-align: center;"><img src="673793-20151230204258057-82126781.jpg" alt="" width="591" height="367"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图14 单层神经网络(Z<sub>2</sub>)</span></p><br><p style="text-align: center;">&nbsp;</p><br><p>　　可以看到，z<sub>2</sub>的计算中除了三个新的权值：<span style="font-family: verdana, geneva;">w<sub>4</sub>，w<sub>5</sub>，w<sub>6</sub>以外，其他与z<sub>1</sub>是一样的</span>。</p><br><p>　　整个网络的输出如下图。</p><br><p style="text-align: center;"><img src="673793-20151230204606760-610264555.jpg" alt="" width="604" height="414"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图15 单层神经网络(Z<sub>1</sub>和Z<sub>2</sub>)</span></p><br><p style="text-align: center;">&nbsp;</p><br><p>　　<span style="font-family: &#39;times new roman&#39;, times;">目前的表达公式有一点不让人满意的就是：<span style="font-family: verdana, geneva;">w<sub>4</sub>，w<sub>5</sub>，w<sub>6</sub></span>是后来加的，很难表现出跟原先的<span style="font-family: verdana, geneva;">w<sub>1</sub>，w<sub>2</sub>，w<sub>3</sub></span>的关系。</span></p><br><p><span style="font-family: &#39;times new roman&#39;, times;">　　因此我们改用二维的下标，用<span style="font-family: verdana, geneva;">w<sub>x,y</sub>来表达一个权值</span>。下标中的<span style="font-family: verdana, geneva;">x</span>代表后一层神经元的序号，而<span style="font-family: verdana, geneva;">y</span>代表前一层神经元的序号（序号的顺序从上到下）。</span></p><br><p><span style="font-family: &#39;times new roman&#39;, times;">　　例如，</span><span style="font-family: &#39;times new roman&#39;, times;"><span style="font-family: verdana, geneva;">w<sub>1,2</sub></span>代表后一层的第1个神经元与前一层的第2个神经元的连接的权值（这种标记方式参照了<span style="font-family: verdana, geneva;">Andrew Ng</span>的课件）。根据以上方法标记，我们有了下图。</span></p><br><p style="text-align: center;"><img src="673793-20151230205437995-673856644.jpg" alt="" width="630" height="417"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图16 单层神经网络(扩展)</span></p><br><p style="text-align: center;">&nbsp;</p><br><p><span style="font-family: 宋体;">　　如果我们仔细看输出的计算公式，会发现这两个公式就是线性代数方程组。因此可以用矩阵乘法来表达这两个公式。</span></p><br><p><span style="font-family: 宋体;">　　例如，输入的变量是<span style="font-family: verdana, geneva;">[a<sub>1</sub>，a<sub>2</sub>，a<sub>3</sub>]<sup>T</sup></span>（代表由<span style="font-family: verdana, geneva;">a<sub>1</sub>，a<sub>2</sub>，a<sub>3</sub></span>组成的列向量），用向量<span style="font-family: verdana, geneva;"><strong>a</strong>来表示。</span>方程的左边是<span style="font-family: verdana, geneva;">[z<sub>1</sub>，z<sub>2</sub>]<sup>T</sup></span>，用向量<span style="font-family: verdana, geneva;"><strong>z</strong></span>来表示。</span></p><br><p><span style="font-family: 宋体;">　　系数则是矩阵<span style="font-family: verdana, geneva;"><strong>W</strong></span>（2行3列的矩阵，排列形式与公式中的一样）。</span></p><br><p><span style="font-family: 宋体;">　　于是，输出公式可以改写成：</span></p><br><p style="text-align: center;"><span style="font-family: 宋体;"><span style="font-family: verdana, geneva;">g(<strong>W</strong> <em> <strong>a</strong>) = <strong>z</strong>;</em></span><br></span></p><br><p style="text-align: center;">&nbsp;</p><br><p><span style="font-family: 宋体;">　　这个公式就是神经网络中从前一层计算后一层的<strong>矩阵运算。</strong><br></span></p><br><p><strong>　　3.效果</strong></p><br><p>　　与神经元模型不同，感知器中的权值是通过训练得到的。因此，根据以前的知识我们知道，感知器类似一个<strong>逻辑回归</strong>模型，可以做线性分类任务。</p><br><p>　　我们可以用<strong>决策分界</strong>来形象的表达分类的效果。决策分界就是在二维的数据平面中划出一条直线，当数据的维度是3维的时候，就是划出一个平面，当数据的维度是n维时，就是划出一个n-1维的超平面。</p><br><p>　　下图显示了在二维平面中划出决策分界的效果，也就是感知器的分类效果。</p><br><p style="text-align: center;"><img src="673793-20151231073138323-962584420.png" alt="" width="540" height="447"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图17 单层神经网络（决策分界）</span></p><br><p>　　</p><br><p><strong style="line-height: 1.5;">　　4.影响</strong><span style="line-height: 1.5;">　</span></p><br><p>　　感知器只能做简单的线性分类任务。但是当时的人们热情太过于高涨，并没有人清醒的认识到这点。于是，当人工智能领域的巨擘Minsky指出这点时，事态就发生了变化。</p><br><p>　　Minsky在1969年出版了一本叫《Perceptron》的书，里面用详细的数学证明了感知器的弱点，尤其是感知器对XOR（异或）这样的简单分类任务都无法解决。</p><br><p>　　Minsky认为，如果将计算层增加到两层，计算量则过大，而且没有有效的学习算法。所以，他认为研究更深层的网络是没有价值的。（本文成文后一个月，即2016年1月，<a href="http://cacm.acm.org/news/197529-in-memoriam-marvin-minsky-1927-2016/fulltext" target="_blank">Minsky在美国去世</a>。谨在本文中纪念这位著名的计算机研究专家与大拿。）</p><br><p style="text-align: center;"><img src="673793-20151221213056031-351364155.jpg" alt="" width="198" height="203">&nbsp; &nbsp;</p><br><p style="text-align: center;"><span style="font-family: 黑体;">图18 Marvin Minsky</span></p><br><p>　　</p><br><p>　　由于Minsky的巨大影响力以及书中呈现的悲观态度，让很多学者和实验室纷纷放弃了神经网络的研究。神经网络的研究陷入了冰河期。这个时期又被称为<span style="font-family: 宋体;">“<span style="font-family: verdana, geneva;">AI winter</span>”</span>。</p><br><p>　　接近10年以后，对于两层神经网络的研究才带来神经网络的复苏。</p><br><p>&nbsp;</p><br><p><strong><a name="fourth"></a>四. 两层神经网络（多层感知器）</strong></p><br><p><strong>　　1.引子</strong></p><br><p class="p">　　两层神经网络是本文的重点，因为正是在这时候，神经网络开始了大范围的推广与使用。</p><br><p class="p">　　Minsky说过单层神经网络无法解决异或问题。但是当增加一个计算层以后，两层神经网络不仅可以解决异或问题，而且具有非常好的非线性分类效果。不过两层神经网络的计算是一个问题，没有一个较好的解法。</p><br><p class="p">　　<span style="font-family: Verdana;">1986</span><span style="font-family: 宋体;">年，</span><span style="font-family: Verdana;">Rumelhar</span><span style="font-family: 宋体;">和</span><span style="font-family: Verdana;">Hinton</span><span style="font-family: 宋体;">等人提出了反向传播（</span><span style="font-family: Verdana;">Backpropagation</span><span style="font-family: 宋体;">，</span><span style="font-family: Verdana;">BP</span><span style="font-family: 宋体;">）算法，解决了两层神经网络所需要的复杂计算量问题，从而带动了业界使用两层神经网络研究的热潮。</span><span style="font-family: 宋体;"><span style="font-family: verdana, Arial, Helvetica, sans-serif; line-height: 1.5;">目前，大量的教授神经网络的教材，都是重点介绍两层（带一个隐藏层）神经网络的内容。</span><span style="font-family: Verdana;">&nbsp;</span></span></p><br><p class="p"><span style="font-family: 宋体;"><span style="font-family: Verdana;">　　这时候的Hinton还很年轻，30年以后，正是他重新定义了神经网络，带来了神经网络复苏的又一春。</span></span></p><br><p style="text-align: center;">&nbsp; &nbsp;&nbsp;<img src="673793-20151222162306171-1025091923.jpg" alt="" width="138" height="208">&nbsp; &nbsp;&nbsp;<img src="673793-20151222163144687-406696976.jpg" alt="" width="170" height="209"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图19 David&nbsp;Rumelhart（左）以及&nbsp;Geoffery Hinton（右）</span></p><br><p style="text-align: center;">&nbsp;</p><br><p><strong>　　2.结构</strong></p><br><p>　　两层神经网络除了包含一个输入层，一个输出层以外，还增加了一个中间层。此时，中间层和输出层都是计算层。我们扩展上节的单层神经网络，在右边新加一个层次（只含有一个节点）。</p><br><p>　　现在，我们的权值矩阵增加到了两个，我们用上标来区分不同层次之间的变量。</p><br><p>　　例如a<sub>x</sub><sup>(y)</sup>代表第y层的第x个节点。z<sub>1</sub>，z<sub>2</sub>变成了a<sub>1</sub><sup>(2)</sup>，a<sub>2</sub><sup>(2)</sup>。下图给出了a<sub>1</sub><sup>(2)</sup>，a<sub>2</sub><sup>(2)</sup>的计算公式。</p><br><p style="text-align: center;"><img src="673793-20151222164731249-360921014.jpg" alt="" width="568" height="390"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图20 两层神经网络（中间层计算）</span></p><br><p>&nbsp;</p><br><p>　　计算最终输出z的方式是利用了中间层的a<sub>1</sub><sup>(2)</sup>，a<sub>2</sub><sup>(2)</sup>和第二个权值矩阵计算得到的，如下图。</p><br><p style="text-align: center;"><img src="673793-20151222171056156-387680541.jpg" alt="" width="577" height="389"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图21 两层神经网络（输出层计算）</span></p><br><p style="text-align: center;">&nbsp;</p><br><p>　　<span style="font-family: 宋体;">假设我们的预测目标是一个向量，那么与前面类似，只需要在“输出层”再增加节点即可。</span></p><br><p><span style="font-family: 宋体;">　　我们使用向量和矩阵来表示层次中的变量。<span style="font-family: verdana, geneva;"><strong>a</strong><sup>(1)</sup>，<strong>a</strong><sup>(2)</sup>，<strong>z</strong></span>是网络中传输的向量数据。<span style="font-family: verdana, geneva;"><strong>W</strong><sup>(1)</sup>和<strong>W</strong><sup>(2)</sup></span>是网络的矩阵参数。</span><span style="font-family: 宋体;">如下图。</span></p><br><p style="text-align: center;"><img src="673793-20151222171328140-1303075636.jpg" alt="" width="423" height="389"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图22 两层神经网络（向量形式）</span></p><br><p style="text-align: center;">&nbsp;</p><br><p><span style="font-family: 宋体;">　　使用矩阵运算来表达整个计算公式的话如下：</span></p><br><p style="text-align: center;"><span style="font-family: 宋体;">&nbsp; <span style="font-family: verdana, geneva;">g(<strong>W</strong><sup>(1)</sup>&nbsp;&nbsp;<strong>a</strong><sup>(1)</sup>) =&nbsp;<strong>a</strong><sup>(2)</sup>;&nbsp;</span></span></p><br><p style="text-align: center;"><span style="font-family: verdana, geneva;">g(<strong>W</strong><sup>(2)</sup>&nbsp;<em>&nbsp;<strong>a</strong><sup>(2)</sup>) =&nbsp;<strong>z</strong>;</em></span></p><br><p style="text-align: center;">&nbsp;</p><br><p><span style="font-family: 宋体;">　　由此可见，使用矩阵运算来表达是很简洁的，而且也不会受到节点数增多的影响（无论有多少节点参与运算，乘法两端都只有一个变量）。因此神经网络的教程中大量使用矩阵运算来描述。</span></p><br><p><span style="font-family: 宋体;">　　需要说明的是，至今为止，我们对神经网络的结构图的讨论中都没有提到偏置节点（<span style="font-family: verdana, geneva;">bias unit</span>）。事实上，这些节点是默认存在的。它本质上是一个只含有存储功能，且存储值永远为1的单元。</span><span style="font-family: 宋体;">在神经网络的每个层次中，除了输出层以外，都会含有这样一个偏置单元。正如线性回归模型与逻辑回归模型中的一样。</span></p><br><p><span style="font-family: 宋体;">　　偏置单元与后一层的所有节点都有连接，我们设这些参数值为向量<span style="font-family: verdana, geneva;"><strong>b</strong></span>，称之为偏置。如下图。</span></p><br><p style="text-align: center;"><img src="673793-20151226111144687-604911384.jpg" alt="" width="431" height="512"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图23 两层神经网络（考虑偏置节点）</span></p><br><p style="text-align: center;">&nbsp;</p><br><p style="text-align: left;">　　可以看出，偏置节点很好认，因为其没有输入（前一层中没有箭头指向它）。有些神经网络的结构图中会把偏置节点明显画出来，有些不会。一般情况下，我们都不会明确画出偏置节点。&nbsp;</p><br><p>　　在考虑了偏置以后的一个神经网络的矩阵运算如下：</p><br><p style="text-align: center;">&nbsp;&nbsp;g(<strong>W</strong><sup>(1)</sup>&nbsp;&nbsp;<strong>a</strong><sup>(1)&nbsp;</sup>+ <strong>b</strong><sup>(1)</sup>) =&nbsp;<strong>a</strong><sup>(2)</sup>;&nbsp;</p><br><p style="text-align: center;">g(<strong>W</strong><sup>(2)</sup>&nbsp;<em>&nbsp;<strong>a</strong><sup>(2)&nbsp;</sup>+ <strong>b</strong><sup>(2)</sup>) =&nbsp;<strong>z</strong>;</em></p><br><p style="text-align: center;">&nbsp;</p><br><p>　　需要说明的是，在两层神经网络中，我们不再使用sgn函数作为函数g，而是使用平滑函数sigmoid作为函数g。我们把函数g也称作激活函数（active&nbsp;function）。</p><br><p>　　事实上，神经网络的本质就是通过参数与激活函数来拟合特征与目标之间的真实函数关系。初学者可能认为画神经网络的结构图是为了在程序中实现这些圆圈与线，但在一个神经网络的程序中，既没有“线”这个对象，也没有“单元”这个对象。实现一个神经网络最需要的是线性代数库。</p><br><p><strong>　　3.效果</strong></p><br><p>　　与单层神经网络不同。理论证明，两层神经网络可以无限逼近任意连续函数。</p><br><p>　　这是什么意思呢？也就是说，面对复杂的非线性分类任务，两层（带一个隐藏层）神经网络可以分类的很好。</p><br><p>　　下面就是一个例子（此两图来自colah的<a href="http://colah.github.io/posts/2014-03-NN-Manifolds-Topology/" target="_blank">博客</a>），红色的线与蓝色的线代表数据。而红色区域和蓝色区域代表由神经网络划开的区域，两者的分界线就是决策分界。</p><br><p style="text-align: center;"><img src="673793-20151231073619073-461403542.png" alt=""></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图24 两层神经网络（决策分界）</span></p><br><p>　　</p><br><p>　　可以看到，这个两层神经网络的决策分界是非常平滑的曲线，而且分类的很好。有趣的是，前面已经学到过，单层网络只能做线性分类任务。而两层神经网络中的后一层也是线性分类层，应该只能做线性分类任务。为什么两个线性分类任务结合就可以做非线性分类任务？</p><br><p>　　我们可以把输出层的决策分界单独拿出来看一下。就是下图。</p><br><p style="text-align: center;"><img src="673793-20151231074314604-2050732128.png" alt=""></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图25 两层神经网络（空间变换）</span></p><br><p style="text-align: center;">&nbsp;</p><br><p>　　可以看到，输出层的决策分界仍然是直线。关键就是，从输入层到隐藏层时，数据发生了空间变换。也就是说，两层神经网络中，隐藏层对原始的数据进行了一个空间变换，使其可以被线性分类，然后输出层的决策分界划出了一个线性分类分界线，对其进行分类。</p><br><p>　　这样就导出了两层神经网络可以做非线性分类的关键–隐藏层。联想到我们一开始推导出的矩阵公式，我们知道，矩阵和向量相乘，本质上就是对向量的坐标空间进行一个变换。因此，隐藏层的参数矩阵的作用就是使得数据的原始坐标空间从线性不可分，转换成了线性可分。</p><br><p>　　两层神经网络通过两层的线性模型模拟了数据内真实的非线性函数。因此，多层的神经网络的本质就是复杂函数拟合。</p><br><p>　　下面来讨论一下隐藏层的节点数设计。在设计一个神经网络时，输入层的节点数需要与特征的维度匹配，输出层的节点数要与目标的维度匹配。而中间层的节点数，却是由设计者指定的。<span style="font-family: 宋体;">因此，“自由”把握在设计者的手中。</span>但是，节点数设置的多少，却会影响到整个模型的效果。如何决定这个自由层的节点数呢？目前业界没有完善的理论来指导这个决策。一般是根据经验来设置。较好的方法就是预先设定几个可选值，通过切换这几个值来看整个模型的预测效果，选择效果最好的值作为最终选择。这种方法又叫做<span style="font-family: Verdana;">Grid&nbsp;Search</span><span style="font-family: 宋体;">（网格搜索）。</span></p><br><p style="text-align: left;">　　了解了两层神经网<span style="line-height: 1.5;">络的结构以后，我们就可以看懂其它类似的结构图。例如EasyPR字符识别网络架构（下图）。</span></p><br><p style="text-align: center;"><img src="673793-20151226122337406-1923048422.jpg" alt="" width="550" height="393"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图26 EasyPR字符识别网络</span></p><br><p style="text-align: center;">&nbsp;</p><br><p style="text-align: left;">　　EasyPR使用了字符的图像去进行字符文字的识别。输入是120维的向量。输出是要预测的文字类别，共有65类。根据实验，我们测试了一些隐藏层数目，发现当值为40时，整个网络在测试集上的效果较好，因此选择网络的最终结构就是120，40，65。</p><br><p><strong>　　4.训练</strong></p><br><p>　　下面简单介绍一下两层神经网络的训练。</p><br><p>　　在Rosenblat提出的感知器模型中，模型中的参数可以被训练，但是使用的方法较为简单，并没有使用目前机器学习中通用的方法，这导致其扩展性与适用性非常有限。从两层神经网络开始，神经网络的研究人员开始使用机器学习相关的技术进行神经网络的训练。例如用大量的数据（1000-10000左右），使用算法进行优化等等，从而使得模型训练可以获得性能与数据利用上的双重优势。</p><br><p>　　机器学习模型训练的目的，就是使得参数尽可能的与真实的模型逼近。具体做法是这样的。首先给所有参数赋上随机值。我们使用这些随机生成的参数值，来预测训练数据中的样本。样本的预测目标为<span style="font-family: verdana, geneva;">y<sub>p</sub></span>，真实目标为<span style="font-family: verdana, geneva;">y</span>。那么，定义一个值loss，计算公式如下。</p><br><p style="text-align: center;">loss = (y<sub>p&nbsp;</sub>- y)<sup>2</sup></p><br><p style="text-align: center;">&nbsp;</p><br><p>　　这个值称之为<strong>损失</strong>（loss），我们的目标就是使对所有训练数据的损失和尽可能的小。</p><br><p>　　如果将先前的神经网络预测的矩阵公式带入到y<sub>p</sub>中（因为有z=y<sub>p</sub>），那么我们可以把损失写为关于参数（parameter）的函数，这个函数称之为<strong>损失函数</strong>（loss function）。下面的问题就是求：如何优化参数，能够让损失函数的值最小。</p><br><p>　　此时这个问题就被转化为一个优化问题。一个常用方法就是高等数学中的求导，但是这里的问题由于参数不止一个，求导后计算导数等于0的运算量很大，所以一般来说解决这个优化问题使用的是<strong>梯度下降</strong>算法。梯度下降算法每次计算参数在当前的梯度，然后让参数向着梯度的反方向前进一段距离，不断重复，直到梯度接近零时截止。一般这个时候，所有的参数恰好达到使损失函数达到一个最低值的状态。</p><br><p>　　在神经网络模型中，由于结构复杂，每次计算梯度的代价很大。因此还需要使用<strong>反向传播</strong>算法。反向传播算法是利用了神经网络的结构进行的计算。不一次计算所有参数的梯度，而是从后往前。首先计算输出层的梯度，然后是第二个参数矩阵的梯度，接着是中间层的梯度，再然后是第一个参数矩阵的梯度，最后是输入层的梯度。计算结束以后，所要的两个参数矩阵的梯度就都有了。</p><br><p>　　反向传播算法可以直观的理解为下图。梯度的计算从后往前，一层层反向传播。前缀E代表着相对导数的意思。</p><br><p style="text-align: center;"><img src="673793-20151229120754198-2003498733.jpg" alt="" width="403" height="387"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图27 反向传播算法</span></p><br><p>&nbsp;</p><br><p><span style="line-height: 1.5;">　　反向传播算法的启示是数学中的<strong>链式法则</strong>。在此需要说明的是，尽管早期神经网络的研究人员努力从生物学中得到启发，但从BP算法开始，研究者们更多地从数学上寻求问题的最优解。不再盲目模拟人脑网络是神经网络研究走向成熟的标志。正如科学家们可以从鸟类的飞行中得到启发，但没有必要一定要完全模拟鸟类的飞行方式，也能制造可以飞天的飞机。</span></p><br><p><span style="line-height: 1.5;">　　优化问题只是训练中的一个部分。机器学习问题之所以称为学习问题，而不是优化问题，就是因为它不仅要求数据在训练集上求得一个较小的误差，在测试集上也要表现好。因为模型最终是要部署到没有见过训练数据的真实场景。提升模型在测试集上的预测效果的主题叫做<strong>泛化</strong>（generalization），相关方法被称作正则化（regularization）。</span><span style="line-height: 1.5;">神经网络中常用的泛化技术有<strong>权重衰减</strong>等。</span></p><br><p><strong>　　5.影响</strong></p><br><p class="p">　　两层神经网络在多个地方的应用说明了其效用与价值。10年前困扰神经网络界的异或问题被轻松解决。神经网络在这个时候，已经可以发力于语音识别，图像识别，自动驾驶等多个领域。</p><br><p class="p">　　历史总是惊人的相似，神经网络的学者们再次登上了《纽约时报》的专访。人们认为神经网络可以解决许多问题。就连娱乐界都开始受到了影响，当年的《终结者》电影中的阿诺都赶时髦地说一句：我的CPU是一个神经网络处理器，一个会学习的计算机。</p><br><p>　　但是神经网络仍然存在若干的问题：尽管使用了BP算法，一次神经网络的训练仍然耗时太久，而且困扰训练优化的一个问题就是局部最优解问题，这使得神经网络的优化较为困难。同时，隐藏层的节点数需要调参，这使得使用不太方便，工程和研究人员对此多有抱怨。</p><br><p>　　90年代中期，由Vapnik等人发明的SVM（Support Vector Machines，支持向量机）算法诞生，很快就在若干个方面体现出了对比神经网络的优势：无需调参；高效；全局最优解。基于以上种种理由，SVM迅速打败了神经网络算法成为主流。</p><br><p style="text-align: center;"><img src="673793-20151224114218312-1112152935.jpg" alt="" width="122" height="182"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图28 Vladimir Vapnik</span></p><br><p style="text-align: center;">&nbsp;</p><br><p>　　神经网络的研究再次陷入了冰河期。当时，只要你的论文中包含神经网络相关的字眼，非常容易被会议和期刊拒收，研究界那时对神经网络的不待见可想而知。</p><br><p>&nbsp;</p><br><p><strong><a name="fifth"></a>五. 多层神经网络（深度学习）</strong></p><br><p><strong>　　1.引子</strong><strong>　</strong>　</p><br><p class="p">　　在被人摒弃的10年中，有几个学者仍然在坚持研究。这其中的棋手就是加拿大多伦多大学的Geoffery Hinton教授。</p><br><p class="p">　　<span style="line-height: 1.5;">2006年，Hinton在《Science》和相关期刊上发表了论文，首次提出了</span><span style="font-family: 宋体;">“深度信念网络”的概念</span><span style="line-height: 1.5;">。</span><span style="font-family: 宋体;">与传统的训练方式不同，“深度信念网络”有一个“<strong>预训练</strong>”（<span style="font-family: verdana, geneva;">pre-training</span>）的过程，这可以方便的让神经网络中的权值找到一个接近最优解的值，之后再使用“<strong>微调</strong>”(<span style="font-family: verdana, geneva;">fine-tuning</span>)技术来对整个网络进行优化训练。这两个技术的运用大幅度减少了训练多层神经网络的时间。他给多层神经网络相关的学习方法赋予了一个新名词–“<strong>深度学习</strong>”。</span></p><br><p class="p">&nbsp;　　很快，深度学习在语音识别领域暂露头角。接着，2012年，深度学习技术又在图像识别领域大展拳脚。Hinton<span style="font-family: 宋体;">与他的学生在</span><span style="font-family: verdana, geneva;">ImageNet</span>竞赛中，用多层的卷积神经网络成功地对包含一千类别的一百万张图片进行了训练，取得了分类错误率<span style="font-family: &#39;Times New Roman&#39;;"><span style="font-family: verdana, geneva;">15</span>%</span><span style="font-family: 宋体;">的好成绩，这个成绩比第二名高了近</span><span style="font-family: verdana, geneva;">11</span><span style="font-family: 宋体;">个百分点，充分证明了多层神经网络识别效果的优越性</span><span style="font-family: 宋体;">。</span></p><br><p class="p"><span style="font-family: 宋体;">　　在这之后，关于深度神经网络的研究与应用不断涌现。</span></p><br><p style="text-align: center;"><img src="673793-20151224145544656-1225191900.jpg" alt="" width="167" height="223"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图29 Geoffery Hinton&nbsp;</span></p><br><p style="text-align: center;">&nbsp;</p><br><p class="p">　　由于篇幅原因，本文不介绍CNN（Conventional Neural Network，卷积神经网络）与RNN（Recurrent Neural Network，递归神经网络）的架构，下面我们只讨论普通的多层神经网络。</p><br><p><strong>　　2.结构</strong></p><br><p>　　我们延续两层神经网络的方式来设计一个多层神经网络。</p><br><p>　　在两层神经网络的输出层后面，继续添加层次。原来的输出层变成中间层，新加的层次成为新的输出层。所以可以得到下图。</p><br><p style="text-align: center;"><img src="673793-20151224204339234-1994620313.jpg" alt="" width="540" height="351"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图30 多层神经网络</span></p><br><p style="text-align: center;">&nbsp;</p><br><p>　　依照这样的方式不断添加，我们可以得到更多层的多层神经网络。公式推导的话其实跟两层神经网络类似，使用矩阵运算的话就仅仅是加一个公式而已。</p><br><p>　　在已知输入<strong>a</strong><sup>(1)</sup>，参数<strong>W</strong><sup>(1)</sup>，<strong>W</strong><sup>(2)</sup>，<strong>W</strong><sup>(3)</sup>的情况下，输出<strong>z</strong>的推导公式如下：</p><br><p style="text-align: center;">&nbsp; &nbsp; &nbsp;g(<strong>W</strong><sup>(1)</sup>&nbsp;&nbsp;<strong>a</strong><sup>(1)</sup>) =&nbsp;<strong>a</strong><sup>(2)</sup>;&nbsp;</p><br><p style="text-align: center;">&nbsp; &nbsp; g(<strong>W</strong><sup>(2)</sup>&nbsp;<em>&nbsp;<strong>a</strong><sup>(2)</sup>) =&nbsp;<strong>a</strong><sup>(3)</sup>;</em></p><br><p style="text-align: center;">g(<strong>W</strong><sup>(3)</sup>&nbsp;&nbsp;<strong>a</strong><sup>(3)</sup>) = <strong>z</strong>;</p><br><p style="text-align: center;">&nbsp;</p><br><p>　　多层神经网络中，输出也是按照一层一层的方式来计算。从最外面的层开始，算出所有单元的值以后，再继续计算更深一层。只有当前层所有单元的值都计算完毕以后，才会算下一层。有点像计算向前不断推进的感觉。所以这个过程叫做<span style="font-family: 宋体;">“正向传播”</span>。</p><br><p>　　下面讨论一下多层神经网络中的参数。</p><br><p>　　首先我们看第一张图，可以看出<strong>W</strong><sup>(1)</sup>中有6个参数，<strong>W</strong><sup>(2)</sup>中有4个参数，<strong>W</strong><sup>(3)</sup>中有6个参数，所以整个神经网络中的参数有16个（这里我们不考虑偏置节点，下同）。</p><br><p style="text-align: center;"><img src="673793-20151224212531484-570745053.jpg" alt="" width="591" height="463">&nbsp;</p><br><p style="text-align: center;"><span style="font-family: 黑体;">图31 多层神经网络（较少参数）</span></p><br><p style="text-align: center;">&nbsp;</p><br><p>　　假设我们将中间层的节点数做一下调整。第一个中间层改为3个单元，第二个中间层改为4个单元。</p><br><p>　　经过调整以后，整个网络的参数变成了33个。</p><br><p style="text-align: center;"><img src="673793-20151224213620234-1075501325.jpg" alt="" width="626" height="496">&nbsp;</p><br><p style="text-align: center;"><span style="font-family: 黑体;">图32 多层神经网络（较多参数）</span></p><br><p style="text-align: center;">&nbsp;</p><br><p>　　虽然层数保持不变，但是第二个神经网络的参数数量却是第一个神经网络的接近两倍之多，从而带来了更好的表示（represention）能力。表示能力是多层神经网络的一个重要性质，下面会做介绍。</p><br><p>　　在参数一致的情况下，我们也可以获得一个<span style="font-family: 宋体;">“更深”</span>的网络。</p><br><p style="text-align: center;"><img src="673793-20151224213703109-813423001.jpg" alt="" width="681" height="454">&nbsp;</p><br><p style="text-align: center;"><span style="font-family: 黑体;">图33 多层神经网络（更深的层次）</span></p><br><p>&nbsp;</p><br><p>　　上图的网络中，虽然参数数量仍然是33，但却有4个中间层，是原来层数的接近两倍。这意味着一样的参数数量，可以用更深的层次去表达。</p><br><p><strong>　　3.效果</strong></p><br><p>　　与两层层神经网络不同。多层神经网络中的层数增加了很多。</p><br><p>　　增加更多的层次有什么好处？更深入的表示特征，以及更强的函数模拟能力。</p><br><p>　　更深入的表示特征可以这样理解，随着网络的层数增加，每一层对于前一层次的抽象表示更深入。在神经网络中，每一层神经元学习到的是前一层神经元值的更抽象的表示。例如第一个隐藏层学习到的是<span style="font-family: 宋体;">“边缘”</span>的特征，第二个隐藏层学习到的是由<span style="font-family: 宋体;">“边缘”组成的“形状”</span>的特征，<span style="font-family: 宋体;">第三个隐藏层学习到的是由“形状”组成的“图案”的特征，最后的隐藏层学习到的是由“图案”组成的“目标”的特征</span>。通过抽取更抽象的特征来对事物进行区分，从而获得更好的区分与分类能力。</p><br><p>　　关于逐层特征学习的例子，可以参考下图。</p><br><p style="text-align: center;"><img src="673793-20151231075103229-1126297331.png" alt="">&nbsp;</p><br><p style="text-align: center;"><span style="font-family: 黑体;">图34 多层神经网络（特征学习）</span></p><br><p style="text-align: center;">&nbsp;</p><br><p>　　更强的函数模拟能力是由于随着层数的增加，整个网络的参数就越多。而神经网络其实本质就是模拟特征与目标之间的真实关系函数的方法，更多的参数意味着其模拟的函数可以更加的复杂，可以有更多的<strong>容量</strong>（capcity）去拟合真正的关系。</p><br><p>　　通过研究发现，在参数数量一样的情况下，更深的网络往往具有比浅层的网络更好的识别效率。这点也在ImageNet的多次大赛中得到了证实。从2012年起，每年获得ImageNet冠军的深度神经网络的层数逐年增加，2015年最好的方法GoogleNet是一个多达22层的神经网络。</p><br><p>　　在最新一届的ImageNet大赛上，目前拿到最好成绩的MSRA团队的方法使用的更是一个深达152层的网络！关于这个方法更多的信息有兴趣的可以查阅ImageNet网站。</p><br><p><strong>　　4.训练</strong></p><br><p>　　在单层神经网络时，我们使用的激活函数是sgn函数。到了两层神经网络时，我们使用的最多的是sigmoid函数。而到了多层神经网络时，通过一系列的研究发现，ReLU函数在训练多层神经网络时，更容易收敛，并且预测性能更好。因此，目前在深度学习中，最流行的非线性函数是ReLU函数。ReLU函数不是传统的非线性函数，而是分段线性函数。其表达式非常简单，就是y=max(x,0)。简而言之，在x大于0，输出就是输入，而在x小于0时，输出就保持为0。这种函数的设计启发来自于生物神经元对于激励的线性响应，以及当低于某个阈值后就不再响应的模拟。</p><br><p>　　在多层神经网络中，训练的主题仍然是优化和泛化。当使用足够强的计算芯片（例如GPU图形加速卡）时，梯度下降算法以及反向传播算法在多层神经网络中的训练中仍然工作的很好。目前学术界主要的研究既在于开发新的算法，也在于对这两个算法进行不断的优化，例如，增加了一种带动量因子（momentum）的梯度下降算法。　</p><br><p>　　在深度学习中，泛化技术变的比以往更加的重要。这主要是因为神经网络的层数增加了，参数也增加了，表示能力大幅度增强，很容易出现<strong>过拟合现象</strong>。<span style="line-height: 1.5;">因此正则化技术就显得十分重要。目前，Dropout技术，以及数据扩容（Data-Augmentation）技术是目前使用的最多的正则化技术。</span></p><br><p><strong>　　5.影响</strong></p><br><p class="p">　　目前，深度神经网络在人工智能界占据统治地位。但凡有关人工智能的产业报道，必然离不开深度学习。神经网络界当下的四位引领者除了前文所说的Ng，Hinton以外，还有CNN的发明人Yann Lecun，以及《Deep Learning》的作者Bengio。</p><br><p class="p">　　前段时间一直对人工智能持谨慎态度的马斯克，搞了一个<a href="http://news.cnblogs.com/n/534878/" target="_blank">OpenAI项目</a>，邀请Bengio作为高级顾问。马斯克认为，人工智能技术不应该掌握在大公司如Google，Facebook的手里，更应该作为一种开放技术，让所有人都可以参与研究。马斯克的这种精神值得让人敬佩。</p><br><p style="text-align: center;"><img src="673793-20151228131815214-368589404.png" alt="" width="160" height="188">&nbsp; &nbsp;<img src="673793-20151228131718948-1881649621.png" alt="" width="166" height="189"></p><br><p style="text-align: center;"><span style="font-family: 黑体; font-size: 14px;">图35 Yann LeCun（左）和&nbsp;Yoshua Bengio（右）</span></p><br><p style="text-align: center;">&nbsp;</p><br><p class="p">　　多层神经网络的研究仍在进行中。现在最为火热的研究技术包括RNN，LSTM等，研究方向则是图像理解方面。图像理解技术是给计算机一幅图片，让它用语言来表达这幅图片的意思。ImageNet竞赛也在不断召开，有更多的方法涌现出来，刷新以往的正确率。</p><br><p class="p">&nbsp;</p><br><p><strong><a name="sixth"></a>六. 回顾</strong></p><br><p><strong>　　1.影响</strong><strong>　</strong>　</p><br><p class="p">　　我们回顾一下神经网络发展的历程。<span style="line-height: 1.5;">神经网络的发展历史曲折荡漾，既有被人捧上天的时刻，也有摔落在街头无人问津的时段，中间经历了数次大起大落。</span></p><br><p class="p">　　从单层神经网络（感知器）开始，到包含一个隐藏层的两层神经网络，再到多层的深度神经网络，一共有三次兴起过程。详见下图。</p><br><p style="text-align: center;"><img src="673793-20151228170208120-1856567090.jpg" alt="" width="964" height="523">&nbsp;</p><br><p style="text-align: center;"><span style="font-family: 黑体; font-size: 14px;">图36 三起三落的神经网络</span></p><br><p style="text-align: center;">&nbsp;</p><br><p>　　上图中的顶点与谷底可以看作神经网络发展的高峰与低谷。图中的横轴是时间，以年为单位。纵轴是一个神经网络影响力的示意表示。如果把1949年Hebb模型提出到1958年的感知机诞生这个10年视为落下（没有兴起）的话，那么神经网络算是经历了<span style="font-family: 宋体;">“三起三落”</span>这样一个过程，跟<span style="font-family: 宋体;">“小平”</span>同志类似。俗话说，天将降大任于斯人也，必先苦其心志，劳其筋骨。经历过如此多波折的神经网络能够在现阶段取得成功也可以被看做是磨砺的积累吧。</p><br><p>　　历史最大的好处是可以给现在做参考。科学的研究呈现螺旋形上升的过程，不可能一帆风顺。同时，这也给现在过分热衷深度学习与人工智能的人敲响警钟，因为这不是第一次人们因为神经网络而疯狂了。1958年到1969年，以及1985年到1995，这两个十年间人们对于神经网络以及人工智能的期待并不现在低，可结果如何大家也能看的很清楚。</p><br><p>　　因此，冷静才是对待目前深度学习热潮的最好办法。如果因为深度学习火热，或者可以有<span style="font-family: 宋体;">“钱景”</span>就一窝蜂的涌入，那么最终的受害人只能是自己。神经网络界已经两次有被人们捧上天了的境况，相信也对于捧得越高，摔得越惨这句话深有体会。因此，神经网络界的学者也必须给这股热潮浇上一盆水，不要让媒体以及投资家们过分的高看这门技术。很有可能，三十年河东，三十年河西，在几年后，神经网络就再次陷入谷底。根据上图的历史曲线图，这是很有可能的。</p><br><p><strong>　　2.效果</strong><strong>　</strong>　</p><br><p>　　下面说一下神经网络为什么能这么火热？简而言之，就是其学习效果的强大。随着神经网络的发展，其表示性能越来越强。</p><br><p>　　从单层神经网络，到两层神经网络，再到多层神经网络，下图说明了，随着网络层数的增加，以及激活函数的调整，神经网络所能拟合的决策分界平面的能力。</p><br><p style="text-align: center;"><img src="673793-20151228134016120-1091351096.jpg" alt="" width="984" height="653">&nbsp;</p><br><p style="text-align: center;"><span style="font-family: 黑体;">图37 表示能力不断增强</span></p><br><p style="text-align: center;">&nbsp;</p><br><p>　　可以看出，随着层数增加，其非线性分界拟合能力不断增强。图中的分界线并不代表真实训练出的效果，更多的是示意效果。</p><br><p>　　神经网络的研究与应用之所以能够不断地火热发展下去，与其强大的函数拟合能力是分不开关系的。</p><br><p><strong>　　3.外因</strong><strong>　</strong>　</p><br><p>　　当然，光有强大的内在能力，并不一定能成功。一个成功的技术与方法，不仅需要内因的作用，还需要时势与环境的配合。神经网络的发展背后的外在原因可以被总结为：更强的计算性能，更多的数据，以及更好的训练方法。只有满足这些条件时，神经网络的函数拟合能力才能得已体现，见下图。</p><br><p style="text-align: center;"><img src="673793-20151228170149135-2107087462.jpg" alt="" width="857" height="537">&nbsp;</p><br><p style="text-align: center;"><span style="font-family: 黑体;">图38 发展的外在原因<br></span></p><br><p style="text-align: center;">&nbsp;</p><br><p style="text-align: left;">　　之所以在单层神经网络年代，Rosenblat无法制作一个双层分类器，就在于当时的计算性能不足，Minsky也以此来打压神经网络。但是Minsky没有料到，仅仅10年以后，计算机CPU的快速发展已经使得我们可以做两层神经网络的训练，并且还有快速的学习算法BP。</p><br><p style="text-align: left;">　　但是在两层神经网络快速流行的年代。更高层的神经网络由于计算性能的问题，以及一些计算方法的问题，其优势无法得到体现。直到2012年，研究人员发现，用于高性能计算的图形加速卡（GPU）可以极佳地匹配神经网络训练所需要的要求：高并行性，高存储，没有太多的控制需求，配合预训练等算法，神经网络才得以大放光彩。</p><br><p style="text-align: left;">　　互联网时代，大量的数据被收集整理，更好的训练方法不断被发现。所有这一切都满足了多层神经网络发挥能力的条件。</p><br><p style="text-align: left;">　　<span style="font-family: 宋体;">“</span><span style="font-family: 宋体;">时势造英雄”，正如<span style="font-family: verdana, geneva;">Hinton</span>在<span style="font-family: verdana, geneva;">2006年</span>的论文里说道的</span></p><br><p style="text-align: left;"><span style="font-family: 宋体;">　　“</span><strong>…&nbsp;provided&nbsp;that&nbsp;computers&nbsp;were&nbsp;fast&nbsp;enough,&nbsp;data&nbsp;sets&nbsp;were&nbsp;big&nbsp;enough,&nbsp;and&nbsp;the&nbsp;initial&nbsp;weights&nbsp;were&nbsp;close&nbsp;enough&nbsp;to&nbsp;a&nbsp;good&nbsp;solution.&nbsp;All&nbsp;three&nbsp;conditions&nbsp;are&nbsp;now&nbsp;satisfied.</strong><span style="font-family: 宋体;">”</span>，</p><br><p style="text-align: left;">&nbsp;</p><br><p class="p">　　外在条件的满足也是神经网络从神经元得以发展到目前的深度神经网络的重要因素。</p><br><p>　　除此以外，一门技术的发扬没有<span style="font-family: 宋体;">“伯乐”</span>也是不行的。在神经网络漫长的历史中，正是由于许多研究人员的锲而不舍，不断钻研，才能有了现在的成就。前期的Rosenblat，Rumelhart没有见证到神经网络如今的流行与地位。但是在那个时代，他们为神经网络的发展所打下的基础，却会永远流传下去，不会退色。</p><br><p>&nbsp;</p><br><p class="p"><strong><a name="seventh"></a>七. 展望</strong></p><br><p class="p"><strong><strong>　　1.量子计算</strong></strong></p><br><p class="p">　　回到我们对神经网络历史的讨论，根据历史趋势图来看，神经网络以及深度学习会不会像以往一样再次陷入谷底？作者认为，这个过程可能取决于量子计算机的发展。</p><br><p class="p">　　根据一些最近的研究发现，人脑内部进行的计算可能是类似于量子计算形态的东西。而且目前已知的最大神经网络跟人脑的神经元数量相比，仍然显得非常小，仅不及1%左右。所以未来真正想实现人脑神经网络的模拟，可能需要借助量子计算的强大计算能力。</p><br><p class="p">　　各大研究组也已经认识到了量子计算的重要性。谷歌就在开展量子计算机D-wave的研究，希望用量子计算来进行机器学习，并且在前段时间有了突破性的<a href="http://news.cnblogs.com/n/535307/" target="_blank">进展</a>。国内方面，阿里和中科院合作成立了<a href="http://news.sciencenet.cn/htmlnews/2015/7/323963.shtm" target="_blank">量子计算实验室</a>，意图进行量子计算的研究。</p><br><p class="p">　　如果量子计算发展不力，仍然需要数十年才能使我们的计算能力得以突飞猛进的发展，那么缺少了强大计算能力的神经网络可能会无法一帆风顺的发展下去。这种情况可以类比为80-90年时期神经网络因为计算能力的限制而被低估与忽视。假设量子计算机真的能够与神经网络结合，并且助力真正的人工智能技术的诞生，而且量子计算机发展需要10年的话，那么神经网络可能还有10年的发展期。直到那时期以后，神经网络才能真正接近实现AI这一目标。</p><br><p style="text-align: center;"><img src="673793-20151227175114031-277810977.jpg" alt="" width="419" height="329">&nbsp;</p><br><p style="text-align: center;"><span style="font-family: 黑体; font-size: 14px;">图39 量子计算</span></p><br><p style="text-align: center;">&nbsp;</p><br><p class="p">　　<strong><strong>2.人工智能</strong></strong></p><br><p class="p">　　最后，作者想简单地谈谈对目前人工智能的看法。虽然现在人工智能非常火热，但是距离真正的人工智能还有很大的距离。就拿计算机视觉方向来说，面对稍微复杂一些的场景，以及易于混淆的图像，计算机就可能难以识别。因此，这个方向还有很多的工作要做。</p><br><p class="p">　　就普通人看来，这么辛苦的做各种实验，以及投入大量的人力就是为了实现一些不及孩童能力的视觉能力，未免有些不值。但是这只是第一步。虽然计算机需要很大的运算量才能完成一个普通人简单能完成的识图工作，但计算机最大的优势在于并行化与批量推广能力。使用计算机以后，我们可以很轻易地将以前需要人眼去判断的工作交给计算机做，而且几乎没有任何的推广成本。这就具有很大的价值。正如火车刚诞生的时候，有人嘲笑它又笨又重，速度还没有马快。但是很快规模化推广的火车就替代了马车的使用。人工智能也是如此。这也是为什么目前世界上各著名公司以及政府都对此热衷的原因。</p><br><p class="p">　　目前看来，神经网络要想实现人工智能还有很多的路要走，但方向至少是正确的，下面就要看后来者的不断努力了。</p><br><p style="text-align: center;"><img src="673793-20151231172950167-1599238944.jpg" alt="" width="420" height="280"></p><br><p style="text-align: center;"><span style="font-family: 黑体;">图40 人工智能</span></p><br><p style="text-align: center;">&nbsp;</p><br><p class="p"><strong><a name="eighth"></a>八 总结</strong></p><br><p class="p">　　本文回顾了神经网络的发展历史，从神经元开始，历经单层神经网络，两层神经网络，直到多层神经网络。在历史介绍中穿插讲解神经网络的结构，分类效果以及训练方法等。本文说明了神经网络内部实际上就是矩阵计算，<span style="font-family: 宋体;">在程序中的实现没有“点”和“线”的对象</span>。本文说明了神经网络强大预测能力的根本，就是多层的神经网络可以无限逼近真实的对应函数，从而模拟数据之间的真实关系。除此之外，本文回顾了神经网络发展的历程，分析了神经网络发展的外在原因，包括计算能力的增强，数据的增多，以及方法的创新等。最后，本文对神经网络的未来进行了展望，包括量子计算与神经网络结合的可能性，以及探讨未来人工智能发展的前景与价值。</p><br><p style="text-align: center;">&nbsp;</p><br><p class="p"><strong><a name="nineth"></a>九.&nbsp;后记</strong></p><br><p>　　本篇文章可以视为作者一年来对神经网络的理解与总结，包括实验的体会，书籍的阅读，以及思考的火花等。神经网络虽然重要，但学习并不容易。这主要是由于其结构图较为难懂，以及历史发展的原因，导致概念容易混淆，一些介绍的博客与网站内容新旧不齐。本篇文章着眼于这些问题，没有太多的数学推导，意图以一种简单的，直观的方式对神经网络进行讲解。在2015年最后一天终于写完。希望本文可以对各位有所帮助。</p><br><p>&nbsp;</p><br><p>&nbsp;</p><br><p>　　<strong>作者很感谢能够阅读到这里的读者。如果看完觉得好的话，还请轻轻点一下赞，你们的鼓励就是作者继续行文的动力。本文的备注部分是一些对神经网络学习的建议，供补充阅读与参考。</strong></p><br><p>　　</p><br><p>　　<em>目前为止，<a href="https://github.com/liuruoze/EasyPR" target="_blank">EasyPR</a>的1.4版已经将神经网络（ANN）训练的模块加以开放，开发者们可以使用这个模块来进行自己的字符模型的训练。有兴趣的可以<a href="https://github.com/liuruoze/EasyPR" target="_blank">下载</a>。</em></p><br><p>&nbsp;</p><br><p><strong><a name="tenth"></a>十. 备注</strong></p><br><p><strong>　　</strong>神经网络虽然很重要，但是对于神经网络的学习，却并不容易。这些学习困难主要来自以下三个方面：概念，类别，教程。下面简单说明这三点。</p><br><p><strong>　　1.概念</strong></p><br><p>　　对于一门技术的学习而言，首先最重要的是弄清概念。只有将概念理解清楚，才能顺畅的进行后面的学习。由于神经网络漫长的发展历史，经常会有一些概念容易混淆，让人学习中产生困惑。这里面包括历史的术语，不一致的说法，以及被遗忘的研究等。　</p><br><p class="p">　　<strong>历史的术语</strong></p><br><p>　　这个的代表就是多层感知器（MLP）这个术语。起初看文献时很难理解的一个问题就是，为什么神经网络又有另一个名称：MLP。其实MLP（Multi-Layer Perceptron）的名称起源于50-60年代的感知器（Perceptron）。由于我们在感知器之上又增加了一个计算层，因此称为多层感知器。值得注意的是，虽然叫“多层”，MLP一般都指的是两层（带一个隐藏层的）神经网络。</p><br><p>　　MLP这个术语属于历史遗留的产物。现在我们一般就说神经网络，以及深度神经网络。前者代表带一个隐藏层的两层神经网络，也是EasyPR目前使用的识别网络，后者指深度学习的网络。</p><br><p>　　<strong>不一致的说法<br></strong></p><br><p>　　这个最明显的代表就是损失函数loss&nbsp;function，这个还有两个说法是跟它完全一致的意思，分别是残差函数error&nbsp;function，以及代价函数cost&nbsp;function。loss&nbsp;function是目前深度学习里用的较多的一种说法，caffe里也是这么叫的。cost&nbsp;function则是Ng在coursera教学视频里用到的统一说法。这三者都是同一个意思，都是优化问题所需要求解的方程。虽然在使用的时候不做规定，但是在听到各种讲解时要心里明白。</p><br><p>　　再来就是权重weight和参数parameter的说法，神经网络界由于以前的惯例，一般会将训练得到的参数称之为权重，而不像其他机器学习方法就称之为参数。这个需要记住就好。不过在目前的使用惯例中，也有这样一种规定。那就是非偏置节点连接上的值称之为权重，而偏置节点上的值称之为偏置，两者统一起来称之为参数。</p><br><p>　　另外一个同义词就是激活函数active function和转移函数transfer function了。同样，他们代表一个意思，都是叠加的非线性函数的说法。</p><br><p>　　<strong>被遗忘的研究<br></strong></p><br><p>　　由于神经网络发展历史已经有70年的漫长历史，因此在研究过程中，必然有一些研究分支属于被遗忘阶段。这里面包括各种不同的网络，例如SOM（Self-Organizing Map，自组织特征映射网络），SNN（Synergetic Neural Network，协同神经网络），ART（Adaptive Resonance Theory，自适应共振理论网络）等等。所以看历史文献时会看到许多没见过的概念与名词。</p><br><p>　　有些历史网络甚至会重新成为新的研究热点，例如RNN与LSTM就是80年代左右开始的研究，目前已经是深度学习研究中的重要一门技术，在语音与文字识别中有很好的效果。　</p><br><p>　　对于这些易于混淆以及弄错的概念，务必需要多方参考文献，理清上下文，这样才不会在学习与阅读过程中迷糊。</p><br><p>　　<strong>2.类别</strong></p><br><p>　　下面谈一下关于神经网络中的不同类别。</p><br><p>　　其实本文的名字“神经网络浅讲”并不合适，因为本文并不是讲的是“神经网络”的内容，而是其中的一个子类，也是目前最常说的<strong>前馈神经网络</strong>。根据下图的分类可以看出。</p><br><p style="text-align: center;"><img src="673793-20151227190543499-2614280.jpg" alt="" width="839" height="371">&nbsp;</p><br><p style="text-align: center;"><span style="font-family: 黑体;">图41 神经网络的类别</span></p><br><p>&nbsp;</p><br><p>　　神经网络其实是一个非常宽泛的称呼，它包括两类，一类是用计算机的方式去模拟人脑，这就是我们常说的ANN（人工神经网络），另一类是研究生物学上的神经网络，又叫生物神经网络。对于我们计算机人士而言，肯定是研究前者。</p><br><p>　　在人工神经网络之中，又分为前馈神经网络和反馈神经网络这两种。那么它们两者的区别是什么呢？这个其实在于它们的结构图。我们可以把结构图看作是一个有向图。其中神经元代表顶点，连接代表有向边。对于前馈神经网络中，这个有向图是没有回路的。你可以仔细观察本文中出现的所有神经网络的结构图，确认一下。而对于反馈神经网络中，结构图的有向图是有回路的。反馈神经网络也是一类重要的神经网络。其中Hopfield网络就是反馈神经网络。深度学习中的RNN也属于一种反馈神经网络。</p><br><p>　　具体到前馈神经网络中，就有了本文中所分别描述的三个网络：单层神经网络，双层神经网络，以及多层神经网络。深度学习中的CNN属于一种特殊的多层神经网络。另外，在一些Blog中和文献中看到的BP神经网络是什么？其实它们就是使用了反向传播BP算法的两层前馈神经网络。也是最普遍的一种两层神经网络。</p><br><p>　　通过以上分析可以看出，神经网络这种说法其实是非常广义的，具体在文章中说的是什么网络，需要根据文中的内容加以区分。</p><br><p><strong>　　3.教程</strong></p><br><p>　　如何更好的学习神经网络，认真的学习一门课程或者看一本著作都是很有必要的。</p><br><p>　　说到网络教程的话，这里必须说一下Ng的机器学习课程。对于一个初学者而言，Ng的课程视频是非常有帮助的。Ng一共开设过两门机器学习公开课程：一个是2003年在Standford开设的，面向全球的学生，这个视频现在可以在网易公开课上找到；另一个是2010年专门为Coursera上的用户开设的，需要登陆Coursera上才能学习。</p><br><p>　　但是，需要注意点是，这两个课程对待神经网络的态度有点不同。早些的课程一共有20节课，Ng花了若干节课去专门讲SVM以及SVM的推导，而当时的神经网络，仅仅放了几段视频，花了大概不到20分钟（一节课60分钟左右）。而到了后来的课程时，总共10节的课程中，Ng给了完整的两节给神经网络，详细介绍了神经网络的反向传播算法。同时给SVM只有一节课，并且没有再讲SVM的推导过程。下面两张图分别是Ng介绍神经网络的开篇，可以大致看出一些端倪。</p><br><p style="text-align: center;"><img src="673793-20151230155838057-551533589.jpg" alt="" width="854" height="413">&nbsp;</p><br><p style="text-align: center;"><span style="font-family: 黑体;">图42 Ng与神经网络</span></p><br><p>&nbsp;</p><br><p class="p">　　为什么Ng对待神经网络的反应前后相差那么大？事实上就是深度学习的原因。Ng实践了深度学习的效果，认识到深度学习的基础–神经网络的重要性。这就是他在后面重点介绍神经网络的原因。总之，对于神经网络的学习而言，我更推荐Coursera上的。因为在那个时候，Ng才是真正的把神经网络作为一门重要的机器学习方法去传授。你可以从他上课的态度中感受到他的重视，以及他希望你能学好的期望。</p><br><p>&nbsp;</p><br><p><strong>版权说明：</strong></p><br><p><strong>　　本文中的所有文字，图片，代码的版权都是属于作者和博客园共同所有。欢迎转载，但是务必注明作者与出处。任何未经允许的剽窃以及爬虫抓取都属于侵权，作者和博客园保留所有权利。</strong></p><br><p>&nbsp;&nbsp;</p><br><p><strong>参考文献：</strong></p><br><p><strong>　　</strong>1.<a href="https://www.doc.ic.ac.uk/~nd/surprise_96/journal/vol4/cs11/report.html" target="_blank">Neural Networks</a></p><br><p>　　2.<a href="http://ufldl.stanford.edu/wiki/index.php/Neural_Networks" target="_blank">Andrew Ng&nbsp;Neural Networks&nbsp;</a></p><br><p>　　3.<a href="http://www.36dsj.com/archives/20804" target="_blank">神经网络简史</a><a href="http://www.36dsj.com/archives/20804" target="_blank"><br></a></p><br><p>　　4.<a href="http://www.intsci.ac.cn/shizz/course/kd08.ppt" target="_blank">中科院 史忠植 神经网络&nbsp;讲义</a></p><br><p>　　5.<a href="http://caai.cn/contents/118/1934.html" target="_blank">深度学习 胡晓林</a></p><br><p>&nbsp;</p></div><div id="MySignature"></div><br><div class="clear"></div><br><div id="blog_post_info_block"><br><div id="BlogPostCategory"></div><br><div></div></div></div></div></div></div></div></div></div><script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":110,"height":220},"mobile":{"show":false},"log":false,"tagMode":false});</script></body></html>

      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/机器学习，神经网络/" rel="tag"><i class="fa fa-tag"></i> 机器学习，神经网络</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/05/29/微软笔试算法（一）/" rel="next" title="微软笔试算法（一）">
                <i class="fa fa-chevron-left"></i> 微软笔试算法（一）
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/08/12/机器学习（八）/" rel="prev" title="机器学习（八）">
                机器学习（八） <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="Voidmort" />
            
              <p class="site-author-name" itemprop="name">Voidmort</p>
              <p class="site-description motion-element" itemprop="description">研究AI，撰写影评，热爱音乐，努力健身</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">38</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">9</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">22</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/Voidmort" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:wxj5658@hotmail.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="http://weibo.com/u/1749266905" target="_blank" title="Weibo"><i class="fa fa-fw fa-weibo"></i>Weibo</a>
                  
                </span>
              
            </div>
          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Voidmort</span>

  

  
</div>





        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.3.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.3.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.3.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.3.0"></script>



  



	





  





  










  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  

  


  
  

  

  

  

  

  

<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":110,"height":220},"mobile":{"show":false},"log":false,"tagMode":false});</script></body>
</html>
